---
title: "p8105_hw5_baw2160"
author: "Bryce Wong"
date: "November 5, 2018"
output: github_document
---

```{r}
library(tidyverse)
```

Create a tidy dataframe containing data from all participants, including the subject ID, arm, and observations over time:

* Start with a dataframe containing all file names; the list.files function will help

```{r}
get_names = list.files('./data')
data_prefix = './data/'
file_names = str_c(data_prefix, get_names)
```

* Iterate over file names and read in data for each subject using purrr::map and saving the result as a new variable in the dataframe

```{r}
reading_subjects = function(filename){
  subject_data = read_csv(file = filename) %>% 
    mutate(
      subj_name = filename
    )
  subject_data
}

all_subjects = bind_rows(
  map(.x = file_names, ~ reading_subjects(.x))
) %>% 
  select(subj_name, everything())
```

* Tidy the result; manipulate file names to include control arm and subject ID, make sure weekly observations are “tidy”, and do any other tidying that’s necessary

```{r}
tidy_data = all_subjects %>% 
  gather(key = week, value = observation, week_1:week_8) %>% 
  mutate(subj_name = str_replace(subj_name, "./data/", ""),
         subj_name = str_replace(subj_name, ".csv", ""),
         week = str_replace(week, "week_", ""),
         week = as.numeric(week)
         ) %>%
  separate(subj_name, into = c("study_arm", "subj_id"), sep = "_") %>% 
  mutate(
    subj_id = as.numeric(subj_id)
  )
```

* Make a spaghetti plot showing observations on each subject over time, and comment on differences between groups.
